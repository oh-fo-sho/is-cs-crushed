## 쓰기 지연

JPA의 쓰기 지연(Write-Behind)은 트랜잭션이 커밋되기 전까지 SQL 문을 즉시 실행하지 않고 저장해두었다 한 번에 실행하는 전략이다. 이를 통해 성능을 최적화하고 데이터베이스와의 상호작용을 줄이는 효과를 얻을 수 있다

쓰기에 관련된 SQL은 액션 큐(Action Queue)라는 내부 저장소에 저장된다. SQL 저장소, 쓰기 지연 큐 등으로도 불린다.

### 동작 원리

1. **엔티티 상태 변경 (Insert/Update/Delete)**
   - 엔티티를 생성하고 `persist()`를 호출하거나, 필드를 수정하거나, `remove()`로 삭제 요청을 하면 **즉시 데이터베이스에 반영되지 않는다.**
   - 이 변경 사항은 **영속성 컨텍스트(Persistence Context)** 내부에 반영되고 SQL 문은 **액션 큐(Action Queue)에 저장된다**
2. **트랜잭션 커밋 또는 플러시(Flush)**
   - **트랜잭션이 커밋되거나 명시적으로 `flush()`가 호출될 때**, 액션 큐에 저장된 SQL이 실행된다
   - 이를 통해 데이터베이스와의 통신 횟수를 줄이고 배치 처리로 성능을 최적화한다
3. **SQL 실행**
   - 액션 큐에 저장된 SQL 문은 엔티티의 상태에 따라 순차적으로 실행된다
   - 예: `INSERT` -> `UPDATE` -> `DELETE`
